labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black"))
avocados_no_na
avocados<-read.csv("./Data/avocado.csv")
avocados <- avocados[ ,c(-1)]
as.factor(avocados$region) %>% levels()
avocados$states <- NA
avocados$states <- ifelse(avocados$region== "Albany","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Boise","Idaho",avocados$states)
avocados$states <- ifelse(avocados$region== "California","California",avocados$states)
avocados$states <- ifelse(avocados$region== "CincinnatiDayton","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "Denver","Colorado",avocados$states)
avocados$states <- ifelse(avocados$region== "Houston","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "LasVegas","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "MiamiFtLauderdale","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "NewOrleansMobile","Louisiana",avocados$states)
avocados$states <- ifelse(avocados$region== "PhoenixTucson","Arizona",avocados$states)
avocados$states <- ifelse(avocados$region== "Portland","Oregon",avocados$states)
avocados$states <- ifelse(avocados$region== "Roanoke","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanFrancisco","California",avocados$states)
avocados$states <- ifelse(avocados$region== "StLouis","Missouri",avocados$states)
avocados$states <- ifelse(avocados$region== "Atlanta","Georgia",avocados$states)
avocados$states <- ifelse(avocados$region== "Boston","Massachusetts",avocados$states)
avocados$states <- ifelse(avocados$region== "Charlotte","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "HarrisburgScranton","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "Indianapolis","Indiana",avocados$states)
avocados$states <- ifelse(avocados$region== "LosAngeles","California",avocados$states)
avocados$states <- ifelse(avocados$region== "NewYork","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Orlando","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Pittsburgh","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RaleighGreensboro","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Sacramento","California",avocados$states)
avocados$states <- ifelse(avocados$region== "Seattle","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Syracuse","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "BaltimoreWashington","Maryland",avocados$states)
avocados$states <- ifelse(avocados$region== "BuffaloRochester","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Chicago","Illinois",avocados$states)
avocados$states <- ifelse(avocados$region== "DallasFtWorth","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "GrandRapids","Michigan",avocados$states)
avocados$states <- ifelse(avocados$region== "HartfordSpringfield","Connecticut",avocados$states)
avocados$states <- ifelse(avocados$region== "Jacksonville","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Louisville","Kentucky",avocados$states)
avocados$states <- ifelse(avocados$region== "Nashville","Tennessee",avocados$states)
avocados$states <- ifelse(avocados$region== "Philadelphia","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RichmondNorfolk","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanDiego","California",avocados$states)
avocados$states <- ifelse(avocados$region== "SouthCarolina","South Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Spokane","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Tampa","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "WestTexNewMexico","New Mexico",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black"))
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
unnamed-chunk-4-1.png
avocados_na <- avocados[which(is.na(avocados$states)),]
View(avocados_na)
as.factor(avocados_na$region) %>% levels()
avocados<-read.csv("./Data/avocado.csv")
avocados <- avocados[ ,c(-1)]
as.factor(avocados$region) %>% levels()
as.factor(avocados$region) %>% levels()
as.factor(avocados_no_na$region) %>% levels()
View(avocados_no_na)
avocados<-read.csv("./Data/avocado.csv")
avocados <- avocados[ ,c(-1)]
as.factor(avocados$region) %>% levels()
avocados$states <- NA
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
as.factor(avocados_no_na$region) %>% levels()
avocados$states <- NA
avocados$states <- ifelse(avocados$region== "Albany","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Boise","Idaho",avocados$states)
avocados$states <- ifelse(avocados$region== "California","California",avocados$states)
avocados$states <- ifelse(avocados$region== "CincinnatiDayton","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "Denver","Colorado",avocados$states)
avocados$states <- ifelse(avocados$region== "Houston","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "LasVegas","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "MiamiFtLauderdale","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "NewOrleansMobile","Louisiana",avocados$states)
avocados$states <- ifelse(avocados$region== "PhoenixTucson","Arizona",avocados$states)
avocados$states <- ifelse(avocados$region== "Portland","Oregon",avocados$states)
avocados$states <- ifelse(avocados$region== "Roanoke","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanFrancisco","California",avocados$states)
avocados$states <- ifelse(avocados$region== "StLouis","Missouri",avocados$states)
avocados$states <- ifelse(avocados$region== "Atlanta","Georgia",avocados$states)
avocados$states <- ifelse(avocados$region== "Boston","Massachusetts",avocados$states)
avocados$states <- ifelse(avocados$region== "Charlotte","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "HarrisburgScranton","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "Indianapolis","Indiana",avocados$states)
avocados$states <- ifelse(avocados$region== "LosAngeles","California",avocados$states)
avocados$states <- ifelse(avocados$region== "NewYork","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Orlando","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Pittsburgh","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RaleighGreensboro","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Sacramento","California",avocados$states)
avocados$states <- ifelse(avocados$region== "Seattle","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Syracuse","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "BaltimoreWashington","Maryland",avocados$states)
avocados$states <- ifelse(avocados$region== "BuffaloRochester","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Chicago","Illinois",avocados$states)
avocados$states <- ifelse(avocados$region== "DallasFtWorth","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "GrandRapids","Michigan",avocados$states)
avocados$states <- ifelse(avocados$region== "HartfordSpringfield","Connecticut",avocados$states)
avocados$states <- ifelse(avocados$region== "Jacksonville","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Louisville","Kentucky",avocados$states)
avocados$states <- ifelse(avocados$region== "Nashville","Tennessee",avocados$states)
avocados$states <- ifelse(avocados$region== "Philadelphia","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RichmondNorfolk","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanDiego","California",avocados$states)
avocados$states <- ifelse(avocados$region== "SouthCarolina","South Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Spokane","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Tampa","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "WestTexNewMexico","New Mexico",avocados$states)
avocados$states <- ifelse(avocados$region== "Columbus","Ohio",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
as.factor(avocados_no_na$states) %>% levels()
avocados_na <- avocados[which(is.na(avocados$states)),]
as.factor(avocados_na$states) %>% levels()
as.factor(avocados_na$region) %>% levels()
avocados<-read.csv("./Data/avocado.csv")
avocados <- avocados[ ,c(-1)]
as.factor(avocados$region) %>% levels()
avocados$states <- NA
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "Albany","New York",avocados$states)
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "Boise","Idaho",avocados$states)
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "California","California",avocados$states)
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "CincinnatiDayton","Ohio",avocados$states)
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "Denver","Colorado",avocados$states)
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "Houston","Texas",avocados$states)
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "Albany","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Boise","Idaho",avocados$states)
avocados$states <- ifelse(avocados$region== "California","California",avocados$states)
avocados$states <- ifelse(avocados$region== "CincinnatiDayton","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "Denver","Colorado",avocados$states)
avocados$states <- ifelse(avocados$region== "Houston","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "LasVegas","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "MiamiFtLauderdale","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "NewOrleansMobile","Louisiana",avocados$states)
avocados$states <- ifelse(avocados$region== "PhoenixTucson","Arizona",avocados$states)
avocados$states <- ifelse(avocados$region== "Portland","Oregon",avocados$states)
avocados$states <- ifelse(avocados$region== "Roanoke","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanFrancisco","California",avocados$states)
avocados$states <- ifelse(avocados$region== "StLouis","Missouri",avocados$states)
avocados$states <- ifelse(avocados$region== "Atlanta","Georgia",avocados$states)
avocados$states <- ifelse(avocados$region== "Boston","Massachusetts",avocados$states)
avocados$states <- ifelse(avocados$region== "Charlotte","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "HarrisburgScranton","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "Indianapolis","Indiana",avocados$states)
avocados$states <- ifelse(avocados$region== "LosAngeles","California",avocados$states)
avocados$states <- ifelse(avocados$region== "NewYork","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Orlando","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Pittsburgh","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RaleighGreensboro","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Sacramento","California",avocados$states)
avocados$states <- ifelse(avocados$region== "Seattle","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Syracuse","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "BaltimoreWashington","Maryland",avocados$states)
avocados$states <- ifelse(avocados$region== "BuffaloRochester","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Chicago","Illinois",avocados$states)
avocados$states <- ifelse(avocados$region== "DallasFtWorth","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "GrandRapids","Michigan",avocados$states)
avocados$states <- ifelse(avocados$region== "HartfordSpringfield","Connecticut",avocados$states)
avocados$states <- ifelse(avocados$region== "Jacksonville","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Louisville","Kentucky",avocados$states)
avocados$states <- ifelse(avocados$region== "Nashville","Tennessee",avocados$states)
avocados$states <- ifelse(avocados$region== "Philadelphia","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RichmondNorfolk","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanDiego","California",avocados$states)
avocados$states <- ifelse(avocados$region== "SouthCarolina","South Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Spokane","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Tampa","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "WestTexNewMexico","New Mexico",avocados$states)
avocados$states <- ifelse(avocados$region== "Columbus","Ohio",avocados$states)
as.factor(avocados$states) %>% levels()
avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
avocados[which(is.na(avocados$states)),]
avocados$states <- ifelse(avocados$region== "Detroit","NewYork",avocados$states)
avocados_na <- avocados[which(is.na(avocados$states)),]
avocados[which(is.na(avocados$states)),]
View(avocados_na)
as.factor(avocados_na$region) %>% levels()
as.factor(avocados_no_na$states) %>% levels()
avocados$states <- ifelse(avocados$region== "GreatLakes","Minnesota",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
as.factor(avocados_no_na$states) %>% levels()
as.factor(avocados_na$region) %>% levels()
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
avocados$states <- ifelse(avocados$region== "SouthCentral","Oklahoma",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
as.factor(avocados_no_na$states) %>% levels()
as.factor(avocados_na$region) %>% levels()
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
as.factor(avocados_na$region) %>% levels()
avocados$states <- ifelse(avocados$region== "Southeast","Arkansas",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
as.factor(avocados_na$region) %>% levels()
avocados$states <- ifelse(avocados$region== "Northeast","Maine",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
as.factor(avocados_na$region) %>% levels()
avocados$states <- ifelse(avocados$region== "West","Nevada",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
avocados$states <- ifelse(avocados$region== "West","Arizona",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
as.factor(avocados_no_na$states) %>% levels()
as.factor(avocados_na$region) %>% levels()
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
avocados$states <- ifelse(avocados$region== "West","Nevada",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
as.factor(avocados_no_na$states) %>% levels()
as.factor(avocados_na$region) %>% levels()
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
as.factor(avocados_na$region) %>% levels()
plot_usmap(  data = avocados_no_na,
values = "hits",
#      color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = orange,
labels=FALSE) +
scale_fill_continuous( low = "white", high = orange,
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
plot_usmap(  data = avocados_no_na,
values = "hits",
# color = orange,
labels=FALSE)
plot_usmap(  data = avocados_no_na,
values = "hits",
color = "green",
labels=FALSE) +
scale_fill_continuous( low = "white", high = "green",
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
lot_usmap(  data = avocados_no_na,
values = "hits",
#      color = "green",
labels=FALSE) +
scale_fill_continuous( low = "white", high = "green",
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
plot_usmap(  data = avocados_no_na,
values = "hits",
#      color = "green",
labels=FALSE) +
scale_fill_continuous( low = "white", high = "green",
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = "#239223",
labels=FALSE) +
scale_fill_continuous( low = "white", high = "#239223",
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = "white",
labels=FALSE) +
scale_fill_continuous( low = "white", high = "#239223",
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = "white",
labels=FALSE) +
scale_fill_continuous( low = "#C5DBC5", high = "#239223",
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
avocados<-read.csv("./Data/avocado.csv")
avocados <- avocados[ ,c(-1)]
as.factor(avocados$region) %>% levels()
avocados$states <- NA
as.factor(avocados$states) %>% levels()
avocados$states <- ifelse(avocados$region== "Albany","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Boise","Idaho",avocados$states)
avocados$states <- ifelse(avocados$region== "California","California",avocados$states)
avocados$states <- ifelse(avocados$region== "CincinnatiDayton","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "Denver","Colorado",avocados$states)
avocados$states <- ifelse(avocados$region== "Houston","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "LasVegas","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "MiamiFtLauderdale","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "NewOrleansMobile","Louisiana",avocados$states)
avocados$states <- ifelse(avocados$region== "PhoenixTucson","Arizona",avocados$states)
avocados$states <- ifelse(avocados$region== "Portland","Oregon",avocados$states)
avocados$states <- ifelse(avocados$region== "Roanoke","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanFrancisco","California",avocados$states)
avocados$states <- ifelse(avocados$region== "StLouis","Missouri",avocados$states)
avocados$states <- ifelse(avocados$region== "Atlanta","Georgia",avocados$states)
avocados$states <- ifelse(avocados$region== "Boston","Massachusetts",avocados$states)
avocados$states <- ifelse(avocados$region== "Charlotte","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "HarrisburgScranton","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "Indianapolis","Indiana",avocados$states)
avocados$states <- ifelse(avocados$region== "LosAngeles","California",avocados$states)
avocados$states <- ifelse(avocados$region== "NewYork","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Orlando","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Pittsburgh","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RaleighGreensboro","North Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Sacramento","California",avocados$states)
avocados$states <- ifelse(avocados$region== "Seattle","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Syracuse","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "BaltimoreWashington","Maryland",avocados$states)
avocados$states <- ifelse(avocados$region== "BuffaloRochester","New York",avocados$states)
avocados$states <- ifelse(avocados$region== "Chicago","Illinois",avocados$states)
avocados$states <- ifelse(avocados$region== "DallasFtWorth","Texas",avocados$states)
avocados$states <- ifelse(avocados$region== "GrandRapids","Michigan",avocados$states)
avocados$states <- ifelse(avocados$region== "HartfordSpringfield","Connecticut",avocados$states)
avocados$states <- ifelse(avocados$region== "Jacksonville","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "Louisville","Kentucky",avocados$states)
avocados$states <- ifelse(avocados$region== "Nashville","Tennessee",avocados$states)
avocados$states <- ifelse(avocados$region== "Philadelphia","Pennsylvania",avocados$states)
avocados$states <- ifelse(avocados$region== "RichmondNorfolk","Virginia",avocados$states)
avocados$states <- ifelse(avocados$region== "SanDiego","California",avocados$states)
avocados$states <- ifelse(avocados$region== "SouthCarolina","South Carolina",avocados$states)
avocados$states <- ifelse(avocados$region== "Spokane","Washington",avocados$states)
avocados$states <- ifelse(avocados$region== "Tampa","Florida",avocados$states)
avocados$states <- ifelse(avocados$region== "WestTexNewMexico","New Mexico",avocados$states)
avocados$states <- ifelse(avocados$region== "Columbus","Ohio",avocados$states)
avocados$states <- ifelse(avocados$region== "Detroit","NewYork",avocados$states)
avocados$states <- ifelse(avocados$region== "GreatLakes","Minnesota",avocados$states)
avocados$states <- ifelse(avocados$region== "SouthCentral","Oklahoma",avocados$states)
avocados$states <- ifelse(avocados$region== "Southeast","Arkansas",avocados$states)
avocados$states <- ifelse(avocados$region== "Northeast","Maine",avocados$states)
avocados$states <- ifelse(avocados$region== "West","Nevada",avocados$states)
avocados_no_na <- avocados[which(!is.na(avocados$states)),c(2,14)]
avocados_na <- avocados[which(is.na(avocados$states)),]
as.factor(avocados_no_na$states) %>% levels()
as.factor(avocados_na$region) %>% levels()
avocados_no_na   <- aggregate(avocados_no_na $AveragePrice, by=list(Category=avocados_no_na$states), FUN=mean)
avocados_no_na $fips <-fips(avocados_no_na $Category)
colnames(avocados_no_na ) <- c("state","hits","fips")
plot_usmap(  data = avocados_no_na,
values = "hits",
color = "white",
labels=FALSE) +
scale_fill_continuous( low = "#C5DBC5", high = "#239223",
name = "Popularity", label = scales::comma
) +
theme(legend.position = "right") +
theme(panel.background = element_rect(colour = "black")) +
labs(title = "Popularity of Thanksgiving Google Search by State", caption = "Source: @littlemissdata")
avocados[,1]
knitr::opts_chunk$set(echo = TRUE)
library(shiny)
library(tidyverse)
numericInput("rows", "How many cars?", 5)
renderTable({
avocados<-read.csv("./Data/avocado.csv")
avocados <- avocados[ ,c(-1)]
head(avocados, input$rows)
})
aggregate(avocados_no_na[,var],by=list(Category=avocados_no_na$states), FUN=mean)
View(avocados)
avocados_no_na %>%
group_by(states) %>%
summarize(mean_size = mean(input$rows, na.rm = TRUE))
View(avocados_no_na)
colnames(avocados)
install.packages("shinyWidgets")
